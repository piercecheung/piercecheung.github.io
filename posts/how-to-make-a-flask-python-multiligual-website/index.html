<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Make a Flask Python Website Multilingual | Mindsmining</title><meta name=keywords content="python,flask,website,multilingual"><meta name=description content="A brief summary of how to build a multilingual Flask Python website."><meta name=author content="Pierce Zhang"><link rel=canonical href=https://blog.mindsmining.com/posts/how-to-make-a-flask-python-multiligual-website/><link crossorigin=anonymous href=/assets/css/stylesheet.min.c88963fe2d79462000fd0fb1b3737783c32855d340583e4523343f8735c787f0.css integrity="sha256-yIlj/i15RiAA/Q+xs3N3g8MoVdNAWD5FIzQ/hzXHh/A=" rel="preload stylesheet" as=style><script defer crossorigin=anonymous src=/assets/js/highlight.min.2840b7fccd34145847db71a290569594bdbdb00047097f75d6495d162f5d7dff.js integrity="sha256-KEC3/M00FFhH23GikFaVlL29sABHCX911kldFi9dff8=" onload=hljs.initHighlightingOnLoad()></script>
<link rel=icon href=https://blog.mindsmining.com/images/favicon/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://blog.mindsmining.com/images/favicon/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://blog.mindsmining.com/images/favicon/favicon-32x32.png><link rel=apple-touch-icon href=https://blog.mindsmining.com/images/favicon/apple-touch-icon.png><link rel=mask-icon href=https://blog.mindsmining.com/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><meta name=generator content="Hugo 0.98.0"><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--hljs-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><meta property="og:title" content="Make a Flask Python Website Multilingual"><meta property="og:description" content="A brief summary of how to build a multilingual Flask Python website."><meta property="og:type" content="article"><meta property="og:url" content="https://blog.mindsmining.com/posts/how-to-make-a-flask-python-multiligual-website/"><meta property="article:section" content="posts"><meta property="article:published_time" content="2022-03-25T18:23:00-08:00"><meta property="article:modified_time" content="2022-03-25T18:23:00-08:00"><meta name=twitter:card content="summary"><meta name=twitter:title content="Make a Flask Python Website Multilingual"><meta name=twitter:description content="A brief summary of how to build a multilingual Flask Python website."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://blog.mindsmining.com/posts/"},{"@type":"ListItem","position":2,"name":"Make a Flask Python Website Multilingual","item":"https://blog.mindsmining.com/posts/how-to-make-a-flask-python-multiligual-website/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Make a Flask Python Website Multilingual","name":"Make a Flask Python Website Multilingual","description":"A brief summary of how to build a multilingual Flask Python website.","keywords":["python","flask","website","multilingual"],"articleBody":"I’ve built a website with Flask and Python and it’s only published in English. As the website will be mainly visited by people in China and other countries, I want to make the website a multilingual one, at least bilingual: Chinese and English.\nSo I started to build the multilingual website with Flask-Babel. Here are the steps.\n My existing project structure ├── venv │ ├── bin │ └── include ├── webapp │ ├── __init__.py │ ├── config.py │ ├── routes.py │ ├── static │ │ ├── favicon.ico │ │ └── styles.css │ └── templates │ ├── about.html │ ├── layout.html │ └── index.html ├── app.py └── requirements.txt  Install Flask-Babel The flask extension we need to install is Flask-Babel.\n(venv) $ pip install Flask-Babel Flask-Babel is easy to use, just like others, we need to add the following lines in the __init__.py file to initialize it:\n# ... from flask_babel import Babel app = Flask(__name__) # ... babel = Babel(app) As I’m going to translate the website into Chinese, I’m goint to add a configuration variable in the config.py file:\nclass Config(object):  # ...  LANGUAGES = ['en_US', 'zh_CN'] en_US and zh_CN are the language codes of English and Chinese respectively, with the _US and _CN suffixes to indicate the country code. You can use two-letter codes like en and zh as well.\nThe Babel instance has a localeselector function that is called when a request is made to the website and will return the language code of the user’s browser. The accept_languages object works with the Accept-Language header in the request that specifies the client language and locale perferences. best_match will return the best matches from the list of available languages.\nIn the __init__.py:\nfrom flask import request  # ...  @babel.localeselector def get_locale():  return request.accept_languages.best_match(app.config['LANGUAGES'])  Marking Texts need to be translated Text in the Python Source Code As I have literal strings in the Python source code, like in the flash() statement, I need to mark them as translatable by wrapping them in the _() function. The _() function is a shortcut for gettext().\n# ... flash('Hello, world!') # ... Change the flash() statement to:\nfrom flask_babel import _ # from flask_babel import gettext as _ # ... flash(_('Hello, world!'))  📝 Note: Don’t to forget to import the _() function from flask_babel. The _() function is a shortcut for gettext().\n Texts in the Templates For the text in the templates, the _() function is also available so the text can be marked as translatable in the similar way. For example we have a template about.html:\nh1About Ush1 Change it to:\nh1{{ _('About Us') }}h1  📝 Note: {{ ... }} should be added to enforce the _() function to be called instead of being treated as a literal string.\n  Extracting Texts Once all the texts are marked as translatable with _(), we can translate them. As mentioned in the tutorial of Flask-Babel, the way is to use the pybabel to extract the texts from the source code and put them in the messages.pot file.\nFirst of all, we need to have some config, create babel.cfg file next to app.py:\n[python: webapp/**.py] [jinja2: webapp/templates/**.html] extensions=jinja2.ext.autoescape,jinja2.ext.with_ The first two lines should indicate the source files of source code and template html files respectively. The extensions line indicates two extensions provided by the Jinja2 template engine that help Flask-Babel properly parse template files.\nThen extract the texts from the source code and put them in the messages.pot file:\n(venv) $ pybabel extract -F babel.cfg -k _l -o messages.pot . extracting messages from webapp/__init__.py (extensions=\"jinja2.ext.autoescape,jinja2.ext.with_\") extracting messages from webapp/config.py (extensions=\"jinja2.ext.autoescape,jinja2.ext.with_\") extracting messages from webapp/routes.py (extensions=\"jinja2.ext.autoescape,jinja2.ext.with_\") writing PO template file to messages.pot  📝 Note: The -o option indicates the output file. The -k option indicates the keyword to be used to mark the texts. If you use lazy_gettext() (imported as _l()) to mark the texts, the -k option should be _l. The _() function is by default.\n  Creating a language translation Now let’s create the language translation for the languages we want to translate to. For me, I want to translate the website into Chinese:\n(venv) $ pybabel init -i messages.pot -d webapp/translations -l zh creating catalog webapp/translations/zh/LC_MESSAGES/messages.po based on messages.pot  📝 Note: The -d option indicates the directory where the translations are stored.\n If you want to translate to other languages, just repeate the above steps seperately.\nFollowing is the messages.po that are created:\n# Chinese translations for PROJECT. # Copyright (C) 2022 ORGANIZATION # This file is distributed under the same license as the PROJECT project. # FIRST AUTHOR , 2022. # msgid \"\" msgstr \"\" \"Project-Id-Version: PROJECT VERSION\\n\" \"Report-Msgid-Bugs-To: EMAIL@ADDRESS\\n\" \"POT-Creation-Date: 2022-04-29 14:30-0700\\n\" \"PO-Revision-Date: 2022-04-29 14:32-0700\\n\" \"Last-Translator: FULL NAME \\n\" \"Language: zh\\n\" \"Language-Team: zh \\n\" \"Plural-Forms: nplurals=1; plural=0;\\n\" \"MIME-Version: 1.0\\n\" \"Content-Type: text/plain; charset=utf-8\\n\" \"Content-Transfer-Encoding: 8bit\\n\" \"Generated-By: Babel 2.10.1\\n\" #: webapp/routes.py:29 msgid \"Hello, world!\" msgstr \"\"  📝 Note: After the header, the first line begins with msgid is the original text extracted by _() or _l(), the second line begins with msgstr is the translation.\n You can translate the texts in the messages.po file to the languages you want to translate to. You can do it manually or using the translation editor like poedit.\n Compile the translations When your translation work is done, you need to compile the translation for use:\n(venv) $ pybabel compile -d webapp/translations compiling catalog webapp/translations/zh/LC_MESSAGES/messages.po to webapp/translations/zh/LC_MESSAGES/messages.mo This action will create the messages.mo file in the webapp/translations/zh/LC_MESSAGES directory.\nNow it’s time to test your translation work. One way is to adjust the language preference in your browser. For example, if you want to translate the website into Chinese, you can set the language preference to Simplified Chinese (zh-CN) in your browser’s language settings.\nThe other way is to force the language by making the localeselector function return the language you want to translate to. In the __init__.py file, make a change:\n@babel.localeselector def get_locale():  # return request.accept_languages.best_match(app.config['LANGUAGES'])  return 'zh_CN' Restart the server and you will see the website in Chinese.\n Updating the translations If the website has changed or you want to update the translations, you can use the pybabel to update:\nFirst, you need to re-extract the messages.pot file and then use the pybabel update to update the translations. This update process is kind of intelligent merge, only the changes will be updated.\n(venv) $ pybabel extract -F babel.cfg -k _l -o messages.pot . (venv) $ pybabel update -i messages.pot -d webapp/translations Now you can exam the messages.po file in the webapp/translations/zh/LC_MESSAGES directory to edit the translations. After you finish the editing, you can compile the translations:\n(venv) $ pybabel compile -d webapp/translations  Let the users decide the language My flask app has user login feature so I decided to let the users can decide the language they want to use after they logged in, if they don’t like the language that the browser locale chosed for them.\nThe language that the user selected will be stored in the session dictionary. So I will first check if the session['language'] is set. If it is, I will use it. Otherwise, I will use the browser locale.\nSo in the __init__.py file, make a change:\n@babel.localeselector def get_locale():  try:  language = session['language']  except KeyError:  language = None   if language is not None:  return language  else:  return request.accept_languages.best_match(app.config['LANGUAGES']) Then in the routes.py file, add a new route:\n@app.route(\"/language/\") def set_language(language):  session[\"language\"] = language  return redirect(request.referrer or url_for(\"index\"))  📝 Note: Very straight forward, get the language from the URL and set it to the session. Then redirect to the page that the user came from or to the index page if the user didn’t come from any page. Please note that if the user logged out, the session will be cleared and the language will be set to the browser locale next time the user visit the website.\n ","wordCount":"1295","inLanguage":"en","datePublished":"2022-03-25T18:23:00-08:00","dateModified":"2022-03-25T18:23:00-08:00","author":{"@type":"Person","name":"Pierce Zhang"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://blog.mindsmining.com/posts/how-to-make-a-flask-python-multiligual-website/"},"publisher":{"@type":"Organization","name":"Mindsmining","logo":{"@type":"ImageObject","url":"https://blog.mindsmining.com/images/favicon/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://blog.mindsmining.com/ accesskey=h title="Mindsmining (Alt + H)">Mindsmining</a>
<span class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></span></div><ul id=menu><li><a href=https://blog.mindsmining.com/archives/ title=Archives><span>Archives</span></a></li><li><a href=https://blog.mindsmining.com/languages/ title=Languages><span>Languages</span></a></li><li><a href=https://blog.mindsmining.com/techstacks/ title=TechStacks><span>TechStacks</span></a></li><li><a href=https://blog.mindsmining.com/categories/ title=Categories><span>Categories</span></a></li><li><a href=https://blog.mindsmining.com/tags/ title=Tags><span>Tags</span></a></li><li><a href=https://blog.mindsmining.com/search/ title="Search (Alt + /)" accesskey=/><span>Search</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://blog.mindsmining.com/>Home</a>&nbsp;»&nbsp;<a href=https://blog.mindsmining.com/posts/>Posts</a></div><h1 class=post-title>Make a Flask Python Website Multilingual</h1><div class=post-meta><span title="2022-03-25 18:23:00 -0800 -0800">March 25, 2022</span>&nbsp;·&nbsp;7 min&nbsp;·&nbsp;Pierce Zhang</div></header><div class=toc><details><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><ul><li><a href=#my-existing-project-structure aria-label="My existing project structure">My existing project structure</a></li><li><a href=#install-flask-babel aria-label="Install Flask-Babel">Install Flask-Babel</a></li><li><a href=#marking-texts-need-to-be-translated aria-label="Marking Texts need to be translated">Marking Texts need to be translated</a><ul><li><a href=#text-in-the-python-source-code aria-label="Text in the Python Source Code">Text in the Python Source Code</a></li><li><a href=#texts-in-the-templates aria-label="Texts in the Templates">Texts in the Templates</a></li></ul></li><li><a href=#extracting-texts aria-label="Extracting Texts">Extracting Texts</a></li><li><a href=#creating-a-language-translation aria-label="Creating a language translation">Creating a language translation</a></li><li><a href=#compile-the-translations aria-label="Compile the translations">Compile the translations</a></li><li><a href=#updating-the-translations aria-label="Updating the translations">Updating the translations</a></li><li><a href=#let-the-users-decide-the-language aria-label="Let the users decide the language">Let the users decide the language</a></li></ul></div></details></div><div class=post-content><p>I&rsquo;ve built a website with Flask and Python and it&rsquo;s only published in English. As the website will be mainly visited by people in China and other countries, I want to make the website a multilingual one, at least bilingual: Chinese and English.</p><p>So I started to build the multilingual website with Flask-Babel. Here are the steps.</p><hr><h2 id=my-existing-project-structure>My existing project structure<a hidden class=anchor aria-hidden=true href=#my-existing-project-structure>#</a></h2><pre tabindex=0><code class=language-FileTree data-lang=FileTree>├── venv
│   ├── bin
│   └── include
├── webapp
│   ├── __init__.py
│   ├── config.py
│   ├── routes.py
│   ├── static
│   │   ├── favicon.ico
│   │   └── styles.css
│   └── templates
│       ├── about.html
│       ├── layout.html
│       └── index.html
├── app.py
└── requirements.txt
</code></pre><hr><h2 id=install-flask-babel>Install Flask-Babel<a hidden class=anchor aria-hidden=true href=#install-flask-babel>#</a></h2><p>The flask extension we need to install is <a href=https://flask-babel.tkte.ch/>Flask-Babel</a>.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-zsh data-lang=zsh><span style=display:flex><span><span style=color:#f92672>(</span>venv<span style=color:#f92672>)</span> $ pip install Flask-Babel
</span></span></code></pre></div><p>Flask-Babel is easy to use, just like others, we need to add the following lines in the <code>__init__.py</code> file to initialize it:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#75715e># ...</span>
</span></span><span style=display:flex><span><span style=color:#f92672>from</span> flask_babel <span style=color:#f92672>import</span> Babel
</span></span><span style=display:flex><span>app <span style=color:#f92672>=</span> Flask(__name__)
</span></span><span style=display:flex><span><span style=color:#75715e># ...</span>
</span></span><span style=display:flex><span>babel <span style=color:#f92672>=</span> Babel(app)
</span></span></code></pre></div><p>As I&rsquo;m going to translate the website into Chinese, I&rsquo;m goint to add a configuration variable in the <code>config.py</code> file:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#66d9ef>class</span> <span style=color:#a6e22e>Config</span>(object):
</span></span><span style=display:flex><span>    <span style=color:#75715e># ...</span>
</span></span><span style=display:flex><span>    LANGUAGES <span style=color:#f92672>=</span> [<span style=color:#e6db74>&#39;en_US&#39;</span>, <span style=color:#e6db74>&#39;zh_CN&#39;</span>]
</span></span></code></pre></div><p><code>en_US</code> and <code>zh_CN</code> are the language codes of English and Chinese respectively, with the <code>_US</code> and <code>_CN</code> suffixes to indicate the country code. You can use two-letter codes like <code>en</code> and <code>zh</code> as well.</p><p>The <code>Babel</code> instance has a <code>localeselector</code> function that is called when a request is made to the website and will return the language code of the user&rsquo;s browser. The <code>accept_languages</code> object works with the <code>Accept-Language</code> header in the request that specifies the client language and locale perferences. <code>best_match</code> will return the best matches from the list of available languages.</p><p>In the <code>__init__.py</code>:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#f92672>from</span> flask <span style=color:#f92672>import</span> request
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># ...</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>@babel</span><span style=color:#f92672>.</span>localeselector
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>get_locale</span>():
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> request<span style=color:#f92672>.</span>accept_languages<span style=color:#f92672>.</span>best_match(app<span style=color:#f92672>.</span>config[<span style=color:#e6db74>&#39;LANGUAGES&#39;</span>])
</span></span></code></pre></div><hr><h2 id=marking-texts-need-to-be-translated>Marking Texts need to be translated<a hidden class=anchor aria-hidden=true href=#marking-texts-need-to-be-translated>#</a></h2><h3 id=text-in-the-python-source-code>Text in the Python Source Code<a hidden class=anchor aria-hidden=true href=#text-in-the-python-source-code>#</a></h3><p>As I have literal strings in the Python source code, like in the <code>flash()</code> statement, I need to mark them as translatable by wrapping them in the <code>_()</code> function. The <code>_()</code> function is a shortcut for <code>gettext()</code>.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#75715e># ...</span>
</span></span><span style=display:flex><span>flash(<span style=color:#e6db74>&#39;Hello, world!&#39;</span>)
</span></span><span style=display:flex><span><span style=color:#75715e># ...</span>
</span></span></code></pre></div><p>Change the <code>flash()</code> statement to:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#f92672>from</span> flask_babel <span style=color:#f92672>import</span> _ <span style=color:#75715e># from flask_babel import gettext as _</span>
</span></span><span style=display:flex><span><span style=color:#75715e># ...</span>
</span></span><span style=display:flex><span>flash(_(<span style=color:#e6db74>&#39;Hello, world!&#39;</span>))
</span></span></code></pre></div><blockquote><p>📝 <strong>Note</strong>: Don&rsquo;t to forget to import the <code>_()</code> function from <code>flask_babel</code>. The <code>_()</code> function is a shortcut for <code>gettext()</code>.</p></blockquote><h3 id=texts-in-the-templates>Texts in the Templates<a hidden class=anchor aria-hidden=true href=#texts-in-the-templates>#</a></h3><p>For the text in the templates, the <code>_()</code> function is also available so the text can be marked as translatable in the similar way. For example we have a template <code>about.html</code>:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-html data-lang=html><span style=display:flex><span>&lt;<span style=color:#f92672>h1</span>&gt;About Us&lt;/<span style=color:#f92672>h1</span>&gt;
</span></span></code></pre></div><p>Change it to:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-html data-lang=html><span style=display:flex><span>&lt;<span style=color:#f92672>h1</span>&gt;{{ _(&#39;About Us&#39;) }}&lt;/<span style=color:#f92672>h1</span>&gt;
</span></span></code></pre></div><blockquote><p>📝 <strong>Note</strong>: <code>{{ ... }}</code> should be added to enforce the <code>_()</code> function to be called instead of being treated as a literal string.</p></blockquote><hr><h2 id=extracting-texts>Extracting Texts<a hidden class=anchor aria-hidden=true href=#extracting-texts>#</a></h2><p>Once all the texts are marked as translatable with <code>_()</code>, we can translate them. As mentioned in the tutorial of <a href=https://flask-babel.tkte.ch/>Flask-Babel</a>, the way is to use the <code>pybabel</code> to extract the texts from the source code and put them in the <code>messages.pot</code> file.</p><p>First of all, we need to have some config, create <code>babel.cfg</code> file next to <code>app.py</code>:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>[python: webapp<span style=color:#f92672>/**.</span>py]
</span></span><span style=display:flex><span>[jinja2: webapp<span style=color:#f92672>/</span>templates<span style=color:#f92672>/**.</span>html]
</span></span><span style=display:flex><span>extensions<span style=color:#f92672>=</span>jinja2<span style=color:#f92672>.</span>ext<span style=color:#f92672>.</span>autoescape,jinja2<span style=color:#f92672>.</span>ext<span style=color:#f92672>.</span>with_
</span></span></code></pre></div><p>The first two lines should indicate the source files of source code and template html files respectively. The <code>extensions</code> line indicates two extensions provided by the Jinja2 template engine that help Flask-Babel properly parse template files.</p><p>Then extract the texts from the source code and put them in the <code>messages.pot</code> file:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-zsh data-lang=zsh><span style=display:flex><span><span style=color:#f92672>(</span>venv<span style=color:#f92672>)</span> $ pybabel extract -F babel.cfg -k _l -o messages.pot .
</span></span><span style=display:flex><span>extracting messages from webapp/__init__.py <span style=color:#f92672>(</span>extensions<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;jinja2.ext.autoescape,jinja2.ext.with_&#34;</span><span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>extracting messages from webapp/config.py <span style=color:#f92672>(</span>extensions<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;jinja2.ext.autoescape,jinja2.ext.with_&#34;</span><span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>extracting messages from webapp/routes.py <span style=color:#f92672>(</span>extensions<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;jinja2.ext.autoescape,jinja2.ext.with_&#34;</span><span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>writing PO template file to messages.pot
</span></span></code></pre></div><blockquote><p>📝 <strong>Note</strong>: The <code>-o</code> option indicates the output file. The <code>-k</code> option indicates the keyword to be used to mark the texts. If you use <code>lazy_gettext()</code> (imported as <code>_l()</code>) to mark the texts, the <code>-k</code> option should be <code>_l</code>. The <code>_()</code> function is by default.</p></blockquote><hr><h2 id=creating-a-language-translation>Creating a language translation<a hidden class=anchor aria-hidden=true href=#creating-a-language-translation>#</a></h2><p>Now let&rsquo;s create the language translation for the languages we want to translate to. For me, I want to translate the website into Chinese:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-zsh data-lang=zsh><span style=display:flex><span><span style=color:#f92672>(</span>venv<span style=color:#f92672>)</span> $ pybabel init -i messages.pot -d webapp/translations -l zh
</span></span><span style=display:flex><span>creating catalog webapp/translations/zh/LC_MESSAGES/messages.po based on messages.pot
</span></span></code></pre></div><blockquote><p>📝 <strong>Note</strong>: The <code>-d</code> option indicates the directory where the translations are stored.</p></blockquote><p>If you want to translate to other languages, just repeate the above steps seperately.</p><p>Following is the messages.po that are created:</p><pre tabindex=0><code class=language-File data-lang=File># Chinese translations for PROJECT.
# Copyright (C) 2022 ORGANIZATION
# This file is distributed under the same license as the PROJECT project.
# FIRST AUTHOR &lt;EMAIL@ADDRESS&gt;, 2022.
#
msgid &#34;&#34;
msgstr &#34;&#34;
&#34;Project-Id-Version: PROJECT VERSION\n&#34;
&#34;Report-Msgid-Bugs-To: EMAIL@ADDRESS\n&#34;
&#34;POT-Creation-Date: 2022-04-29 14:30-0700\n&#34;
&#34;PO-Revision-Date: 2022-04-29 14:32-0700\n&#34;
&#34;Last-Translator: FULL NAME &lt;EMAIL@ADDRESS&gt;\n&#34;
&#34;Language: zh\n&#34;
&#34;Language-Team: zh &lt;LL@li.org&gt;\n&#34;
&#34;Plural-Forms: nplurals=1; plural=0;\n&#34;
&#34;MIME-Version: 1.0\n&#34;
&#34;Content-Type: text/plain; charset=utf-8\n&#34;
&#34;Content-Transfer-Encoding: 8bit\n&#34;
&#34;Generated-By: Babel 2.10.1\n&#34;

#: webapp/routes.py:29
msgid &#34;Hello, world!&#34;
msgstr &#34;&#34;
</code></pre><blockquote><p>📝 <strong>Note</strong>: After the header, the first line begins with <code>msgid</code> is the original text extracted by <code>_()</code> or <code>_l()</code>, the second line begins with <code>msgstr</code> is the translation.</p></blockquote><p>You can translate the texts in the <code>messages.po</code> file to the languages you want to translate to. You can do it manually or using the translation editor like <a href=https://poedit.net/>poedit</a>.</p><hr><h2 id=compile-the-translations>Compile the translations<a hidden class=anchor aria-hidden=true href=#compile-the-translations>#</a></h2><p>When your translation work is done, you need to compile the translation for use:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-zsh data-lang=zsh><span style=display:flex><span><span style=color:#f92672>(</span>venv<span style=color:#f92672>)</span> $ pybabel compile -d webapp/translations
</span></span><span style=display:flex><span>compiling catalog webapp/translations/zh/LC_MESSAGES/messages.po to webapp/translations/zh/LC_MESSAGES/messages.mo
</span></span></code></pre></div><p>This action will create the <code>messages.mo</code> file in the <code>webapp/translations/zh/LC_MESSAGES</code> directory.</p><p>Now it&rsquo;s time to test your translation work. One way is to adjust the language preference in your browser. For example, if you want to translate the website into Chinese, you can set the language preference to Simplified Chinese (zh-CN) in your browser&rsquo;s language settings.</p><p>The other way is to force the language by making the <code>localeselector</code> function return the language you want to translate to. In the <code>__init__.py</code> file, make a change:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#a6e22e>@babel</span><span style=color:#f92672>.</span>localeselector
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>get_locale</span>():
</span></span><span style=display:flex><span>    <span style=color:#75715e># return request.accept_languages.best_match(app.config[&#39;LANGUAGES&#39;])</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> <span style=color:#e6db74>&#39;zh_CN&#39;</span>
</span></span></code></pre></div><p>Restart the server and you will see the website in Chinese.</p><hr><h2 id=updating-the-translations>Updating the translations<a hidden class=anchor aria-hidden=true href=#updating-the-translations>#</a></h2><p>If the website has changed or you want to update the translations, you can use the <code>pybabel</code> to update:</p><p>First, you need to re-extract the <code>messages.pot</code> file and then use the <code>pybabel update</code> to update the translations. This update process is kind of intelligent merge, only the changes will be updated.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-zsh data-lang=zsh><span style=display:flex><span><span style=color:#f92672>(</span>venv<span style=color:#f92672>)</span> $ pybabel extract -F babel.cfg -k _l -o messages.pot .
</span></span><span style=display:flex><span><span style=color:#f92672>(</span>venv<span style=color:#f92672>)</span> $ pybabel update -i messages.pot -d webapp/translations
</span></span></code></pre></div><p>Now you can exam the <code>messages.po</code> file in the <code>webapp/translations/zh/LC_MESSAGES</code> directory to edit the translations. After you finish the editing, you can compile the translations:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-zsh data-lang=zsh><span style=display:flex><span><span style=color:#f92672>(</span>venv<span style=color:#f92672>)</span> $ pybabel compile -d webapp/translations
</span></span></code></pre></div><hr><h2 id=let-the-users-decide-the-language>Let the users decide the language<a hidden class=anchor aria-hidden=true href=#let-the-users-decide-the-language>#</a></h2><p>My flask app has user login feature so I decided to let the users can decide the language they want to use after they logged in, if they don&rsquo;t like the language that the browser locale chosed for them.</p><p>The language that the user selected will be stored in the <code>session</code> dictionary. So I will first check if the <code>session['language']</code> is set. If it is, I will use it. Otherwise, I will use the browser locale.</p><p>So in the <code>__init__.py</code> file, make a change:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#a6e22e>@babel</span><span style=color:#f92672>.</span>localeselector
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>get_locale</span>():
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>try</span>:
</span></span><span style=display:flex><span>        language <span style=color:#f92672>=</span> session[<span style=color:#e6db74>&#39;language&#39;</span>]
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>except</span> <span style=color:#a6e22e>KeyError</span>:
</span></span><span style=display:flex><span>        language <span style=color:#f92672>=</span> <span style=color:#66d9ef>None</span>
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> language <span style=color:#f92672>is</span> <span style=color:#f92672>not</span> <span style=color:#66d9ef>None</span>:
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> language
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>else</span>:
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> request<span style=color:#f92672>.</span>accept_languages<span style=color:#f92672>.</span>best_match(app<span style=color:#f92672>.</span>config[<span style=color:#e6db74>&#39;LANGUAGES&#39;</span>])
</span></span></code></pre></div><p>Then in the <code>routes.py</code> file, add a new route:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#a6e22e>@app</span><span style=color:#f92672>.</span>route(<span style=color:#e6db74>&#34;/language/&lt;language&gt;&#34;</span>)
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>set_language</span>(language):
</span></span><span style=display:flex><span>    session[<span style=color:#e6db74>&#34;language&#34;</span>] <span style=color:#f92672>=</span> language
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> redirect(request<span style=color:#f92672>.</span>referrer <span style=color:#f92672>or</span> url_for(<span style=color:#e6db74>&#34;index&#34;</span>))
</span></span></code></pre></div><blockquote><p>📝 <strong>Note</strong>: Very straight forward, get the language from the URL and set it to the <code>session</code>. Then redirect to the page that the user came from or to the <code>index</code> page if the user didn&rsquo;t come from any page. Please note that if the user logged out, the <code>session</code> will be cleared and the language will be set to the browser locale next time the user visit the website.</p></blockquote></div><footer class=post-footer><ul class=post-tags><li><a href=https://blog.mindsmining.com/tags/python/>python</a></li><li><a href=https://blog.mindsmining.com/tags/flask/>flask</a></li><li><a href=https://blog.mindsmining.com/tags/website/>website</a></li><li><a href=https://blog.mindsmining.com/tags/multilingual/>multilingual</a></li></ul><nav class=paginav><a class=next href=https://blog.mindsmining.com/posts/how-to-build-static-website-using-hugo-github-actions/><span class=title>Next Page »</span><br><span>Build static website using Hugo and GitHub Actions</span></a></nav><div class=share-buttons><a target=_blank rel="noopener noreferrer" aria-label="share Make a Flask Python Website Multilingual on twitter" href="https://twitter.com/intent/tweet/?text=Make%20a%20Flask%20Python%20Website%20Multilingual&url=https%3a%2f%2fblog.mindsmining.com%2fposts%2fhow-to-make-a-flask-python-multiligual-website%2f&hashtags=python%2cflask%2cwebsite%2cmultilingual"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM195.519 424.544c135.939.0 210.268-112.643 210.268-210.268.0-3.218.0-6.437-.153-9.502 14.406-10.421 26.973-23.448 36.935-38.314-13.18 5.824-27.433 9.809-42.452 11.648 15.326-9.196 26.973-23.602 32.49-40.92-14.252 8.429-30.038 14.56-46.896 17.931-13.487-14.406-32.644-23.295-53.946-23.295-40.767.0-73.87 33.104-73.87 73.87.0 5.824.613 11.494 1.992 16.858-61.456-3.065-115.862-32.49-152.337-77.241-6.284 10.881-9.962 23.601-9.962 37.088.0 25.594 13.027 48.276 32.95 61.456-12.107-.307-23.448-3.678-33.41-9.196v.92c0 35.862 25.441 65.594 59.311 72.49-6.13 1.686-12.72 2.606-19.464 2.606-4.751.0-9.348-.46-13.946-1.38 9.349 29.426 36.628 50.728 68.965 51.341-25.287 19.771-57.164 31.571-91.8 31.571-5.977.0-11.801-.306-17.625-1.073 32.337 21.15 71.264 33.41 112.95 33.41z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share Make a Flask Python Website Multilingual on linkedin" href="https://www.linkedin.com/shareArticle?mini=true&url=https%3a%2f%2fblog.mindsmining.com%2fposts%2fhow-to-make-a-flask-python-multiligual-website%2f&title=Make%20a%20Flask%20Python%20Website%20Multilingual&summary=Make%20a%20Flask%20Python%20Website%20Multilingual&source=https%3a%2f%2fblog.mindsmining.com%2fposts%2fhow-to-make-a-flask-python-multiligual-website%2f"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM160.461 423.278V197.561h-75.04v225.717h75.04zm270.539.0V293.839c0-69.333-37.018-101.586-86.381-101.586-39.804.0-57.634 21.891-67.617 37.266v-31.958h-75.021c.995 21.181.0 225.717.0 225.717h75.02V297.222c0-6.748.486-13.492 2.474-18.315 5.414-13.475 17.767-27.434 38.494-27.434 27.135.0 38.007 20.707 38.007 51.037v120.768H431zM123.448 88.722C97.774 88.722 81 105.601 81 127.724c0 21.658 16.264 39.002 41.455 39.002h.484c26.165.0 42.452-17.344 42.452-39.002-.485-22.092-16.241-38.954-41.943-39.002z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share Make a Flask Python Website Multilingual on reddit" href="https://reddit.com/submit?url=https%3a%2f%2fblog.mindsmining.com%2fposts%2fhow-to-make-a-flask-python-multiligual-website%2f&title=Make%20a%20Flask%20Python%20Website%20Multilingual"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM446 265.638c0-22.964-18.616-41.58-41.58-41.58-11.211.0-21.361 4.457-28.841 11.666-28.424-20.508-67.586-33.757-111.204-35.278l18.941-89.121 61.884 13.157c.756 15.734 13.642 28.29 29.56 28.29 16.407.0 29.706-13.299 29.706-29.701.0-16.403-13.299-29.702-29.706-29.702-11.666.0-21.657 6.792-26.515 16.578l-69.105-14.69c-1.922-.418-3.939-.042-5.585 1.036-1.658 1.073-2.811 2.761-3.224 4.686l-21.152 99.438c-44.258 1.228-84.046 14.494-112.837 35.232-7.468-7.164-17.589-11.591-28.757-11.591-22.965.0-41.585 18.616-41.585 41.58.0 16.896 10.095 31.41 24.568 37.918-.639 4.135-.99 8.328-.99 12.576.0 63.977 74.469 115.836 166.33 115.836s166.334-51.859 166.334-115.836c0-4.218-.347-8.387-.977-12.493 14.564-6.47 24.735-21.034 24.735-38.001zM326.526 373.831c-20.27 20.241-59.115 21.816-70.534 21.816-11.428.0-50.277-1.575-70.522-21.82-3.007-3.008-3.007-7.882.0-10.889 3.003-2.999 7.882-3.003 10.885.0 12.777 12.781 40.11 17.317 59.637 17.317 19.522.0 46.86-4.536 59.657-17.321 3.016-2.999 7.886-2.995 10.885.008 3.008 3.011 3.003 7.882-.008 10.889zm-5.23-48.781c-16.373.0-29.701-13.324-29.701-29.698.0-16.381 13.328-29.714 29.701-29.714 16.378.0 29.706 13.333 29.706 29.714.0 16.374-13.328 29.698-29.706 29.698zM160.91 295.348c0-16.381 13.328-29.71 29.714-29.71 16.369.0 29.689 13.329 29.689 29.71.0 16.373-13.32 29.693-29.689 29.693-16.386.0-29.714-13.32-29.714-29.693z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share Make a Flask Python Website Multilingual on facebook" href="https://facebook.com/sharer/sharer.php?u=https%3a%2f%2fblog.mindsmining.com%2fposts%2fhow-to-make-a-flask-python-multiligual-website%2f"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H342.978V319.085h66.6l12.672-82.621h-79.272v-53.617c0-22.603 11.073-44.636 46.58-44.636H425.6v-70.34s-32.71-5.582-63.982-5.582c-65.288.0-107.96 39.569-107.96 111.204v62.971h-72.573v82.621h72.573V512h-191.104c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share Make a Flask Python Website Multilingual on whatsapp" href="https://api.whatsapp.com/send?text=Make%20a%20Flask%20Python%20Website%20Multilingual%20-%20https%3a%2f%2fblog.mindsmining.com%2fposts%2fhow-to-make-a-flask-python-multiligual-website%2f"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zm-58.673 127.703c-33.842-33.881-78.847-52.548-126.798-52.568-98.799.0-179.21 80.405-179.249 179.234-.013 31.593 8.241 62.428 23.927 89.612l-25.429 92.884 95.021-24.925c26.181 14.28 55.659 21.807 85.658 21.816h.074c98.789.0 179.206-80.413 179.247-179.243.018-47.895-18.61-92.93-52.451-126.81zM263.976 403.485h-.06c-26.734-.01-52.954-7.193-75.828-20.767l-5.441-3.229-56.386 14.792 15.05-54.977-3.542-5.637c-14.913-23.72-22.791-51.136-22.779-79.287.033-82.142 66.867-148.971 149.046-148.971 39.793.014 77.199 15.531 105.329 43.692 28.128 28.16 43.609 65.592 43.594 105.4-.034 82.149-66.866 148.983-148.983 148.984zm81.721-111.581c-4.479-2.242-26.499-13.075-30.604-14.571-4.105-1.495-7.091-2.241-10.077 2.241-2.986 4.483-11.569 14.572-14.182 17.562-2.612 2.988-5.225 3.364-9.703 1.12-4.479-2.241-18.91-6.97-36.017-22.23C231.8 264.15 222.81 249.484 220.198 245s-.279-6.908 1.963-9.14c2.016-2.007 4.48-5.232 6.719-7.847 2.24-2.615 2.986-4.484 4.479-7.472 1.493-2.99.747-5.604-.374-7.846-1.119-2.241-10.077-24.288-13.809-33.256-3.635-8.733-7.327-7.55-10.077-7.688-2.609-.13-5.598-.158-8.583-.158-2.986.0-7.839 1.121-11.944 5.604-4.105 4.484-15.675 15.32-15.675 37.364.0 22.046 16.048 43.342 18.287 46.332 2.24 2.99 31.582 48.227 76.511 67.627 10.685 4.615 19.028 7.371 25.533 9.434 10.728 3.41 20.492 2.929 28.209 1.775 8.605-1.285 26.499-10.833 30.231-21.295 3.732-10.464 3.732-19.431 2.612-21.298-1.119-1.869-4.105-2.99-8.583-5.232z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share Make a Flask Python Website Multilingual on telegram" href="https://telegram.me/share/url?text=Make%20a%20Flask%20Python%20Website%20Multilingual&url=https%3a%2f%2fblog.mindsmining.com%2fposts%2fhow-to-make-a-flask-python-multiligual-website%2f"><svg viewBox="2 2 28 28"><path d="M26.49 29.86H5.5a3.37 3.37.0 01-2.47-1 3.35 3.35.0 01-1-2.47V5.48A3.36 3.36.0 013 3 3.37 3.37.0 015.5 2h21A3.38 3.38.0 0129 3a3.36 3.36.0 011 2.46V26.37a3.35 3.35.0 01-1 2.47 3.38 3.38.0 01-2.51 1.02zm-5.38-6.71a.79.79.0 00.85-.66L24.73 9.24a.55.55.0 00-.18-.46.62.62.0 00-.41-.17q-.08.0-16.53 6.11a.59.59.0 00-.41.59.57.57.0 00.43.52l4 1.24 1.61 4.83a.62.62.0 00.63.43.56.56.0 00.4-.17L16.54 20l4.09 3A.9.9.0 0021.11 23.15zM13.8 20.71l-1.21-4q8.72-5.55 8.78-5.55c.15.0.23.0.23.16a.18.18.0 010 .06s-2.51 2.3-7.52 6.8z"/></svg></a></div></footer></article></main><footer class=footer><span>&copy; 2022 <a href=https://blog.mindsmining.com/>Mindsmining</a></span>
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://git.io/hugopapermod rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(t){t.preventDefault();var e=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(e)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(e)}']`).scrollIntoView({behavior:"smooth"}),e==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${e}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(t=>{const n=t.parentNode.parentNode,e=document.createElement("button");e.classList.add("copy-code"),e.innerText="copy";function s(){e.innerText="copied!",setTimeout(()=>{e.innerText="copy"},2e3)}e.addEventListener("click",o=>{if("clipboard"in navigator){navigator.clipboard.writeText(t.textContent),s();return}const e=document.createRange();e.selectNodeContents(t);const n=window.getSelection();n.removeAllRanges(),n.addRange(e);try{document.execCommand("copy"),s()}catch(e){}n.removeRange(e)}),n.classList.contains("highlight")?n.appendChild(e):n.parentNode.firstChild==n||(t.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?t.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(e):t.parentNode.appendChild(e))})</script></body></html>